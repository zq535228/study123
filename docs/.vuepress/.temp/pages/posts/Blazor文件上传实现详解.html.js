import comp from "/Users/Zhuanz/reps/study123/vuepress-starter/docs/.vuepress/.temp/pages/posts/Blazor文件上传实现详解.html.vue"
const data = JSON.parse("{\"path\":\"/posts/Blazor%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%AE%9E%E7%8E%B0%E8%AF%A6%E8%A7%A3.html\",\"title\":\"Blazor 文件上传实现详解：SaveToFile 方法剖析\",\"lang\":\"en-US\",\"frontmatter\":{},\"headers\":[{\"level\":2,\"title\":\"简介\",\"slug\":\"简介\",\"link\":\"#简介\",\"children\":[]},{\"level\":2,\"title\":\"代码实现详解\",\"slug\":\"代码实现详解\",\"link\":\"#代码实现详解\",\"children\":[]},{\"level\":2,\"title\":\"功能特点\",\"slug\":\"功能特点\",\"link\":\"#功能特点\",\"children\":[]},{\"level\":2,\"title\":\"使用场景\",\"slug\":\"使用场景\",\"link\":\"#使用场景\",\"children\":[]},{\"level\":2,\"title\":\"注意事项\",\"slug\":\"注意事项\",\"link\":\"#注意事项\",\"children\":[]},{\"level\":2,\"title\":\"代码改进建议\",\"slug\":\"代码改进建议\",\"link\":\"#代码改进建议\",\"children\":[]},{\"level\":2,\"title\":\"总结\",\"slug\":\"总结\",\"link\":\"#总结\",\"children\":[]}],\"git\":{},\"filePathRelative\":\"posts/Blazor文件上传实现详解.md\",\"excerpt\":\"\\n<h2>简介</h2>\\n<p>在 Web 应用开发中，文件上传是一个常见的需求。今天我们来分析一个在 Blazor 应用中实现的文件上传方法 <code>SaveToFile</code>，这个方法展示了如何在服务器端处理文件上传并提供用户反馈。</p>\\n<h2>代码实现详解</h2>\\n<div class=\\\"language-csharp line-numbers-mode\\\" data-highlighter=\\\"prismjs\\\" data-ext=\\\"cs\\\"><pre><code><span class=\\\"line\\\"><span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">async</span> <span class=\\\"token return-type class-name\\\">Task<span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token keyword\\\">bool</span><span class=\\\"token punctuation\\\">&gt;</span></span> <span class=\\\"token function\\\">SaveToFile</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">UploadFile</span> file<span class=\\\"token punctuation\\\">)</span></span>\\n<span class=\\\"line\\\"><span class=\\\"token punctuation\\\">{</span></span>\\n<span class=\\\"line\\\">    <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> ret <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\">    <span class=\\\"token keyword\\\">try</span></span>\\n<span class=\\\"line\\\">    <span class=\\\"token punctuation\\\">{</span></span>\\n<span class=\\\"line\\\">        <span class=\\\"token comment\\\">// 获取wwwroot目录的物理路径</span></span>\\n<span class=\\\"line\\\">        <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> webRootPath <span class=\\\"token operator\\\">=</span> Path<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Combine</span><span class=\\\"token punctuation\\\">(</span>Directory<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">GetCurrentDirectory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"wwwroot\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\">        <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> uploaderFolder <span class=\\\"token operator\\\">=</span> Path<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Combine</span><span class=\\\"token punctuation\\\">(</span>webRootPath<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"images\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"uploader\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\">        </span>\\n<span class=\\\"line\\\">        <span class=\\\"token comment\\\">// 确保目录存在</span></span>\\n<span class=\\\"line\\\">        Directory<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">CreateDirectory</span><span class=\\\"token punctuation\\\">(</span>uploaderFolder<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\">        </span>\\n<span class=\\\"line\\\">        <span class=\\\"token comment\\\">// 生成唯一文件名</span></span>\\n<span class=\\\"line\\\">        file<span class=\\\"token punctuation\\\">.</span>FileName <span class=\\\"token operator\\\">=</span> <span class=\\\"token interpolation-string\\\"><span class=\\\"token string\\\">$\\\"</span><span class=\\\"token interpolation\\\"><span class=\\\"token punctuation\\\">{</span><span class=\\\"token expression language-csharp\\\">Path<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">GetFileNameWithoutExtension</span><span class=\\\"token punctuation\\\">(</span>file<span class=\\\"token punctuation\\\">.</span>OriginFileName<span class=\\\"token punctuation\\\">)</span></span><span class=\\\"token punctuation\\\">}</span></span><span class=\\\"token string\\\">-</span><span class=\\\"token interpolation\\\"><span class=\\\"token punctuation\\\">{</span><span class=\\\"token expression language-csharp\\\">DateTimeOffset<span class=\\\"token punctuation\\\">.</span>Now</span><span class=\\\"token format-string\\\"><span class=\\\"token punctuation\\\">:</span>yyyyMMddHHmmss</span><span class=\\\"token punctuation\\\">}</span></span><span class=\\\"token interpolation\\\"><span class=\\\"token punctuation\\\">{</span><span class=\\\"token expression language-csharp\\\">Path<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">GetExtension</span><span class=\\\"token punctuation\\\">(</span>file<span class=\\\"token punctuation\\\">.</span>OriginFileName<span class=\\\"token punctuation\\\">)</span></span><span class=\\\"token punctuation\\\">}</span></span><span class=\\\"token string\\\">\\\"</span></span><span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\">        <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> fileName <span class=\\\"token operator\\\">=</span> Path<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Combine</span><span class=\\\"token punctuation\\\">(</span>uploaderFolder<span class=\\\"token punctuation\\\">,</span> file<span class=\\\"token punctuation\\\">.</span>FileName<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\">        <span class=\\\"token comment\\\">// 保存文件</span></span>\\n<span class=\\\"line\\\">        ReadToken <span class=\\\"token operator\\\">??=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token constructor-invocation class-name\\\">CancellationTokenSource</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\">        ret <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">await</span> file<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">SaveToFileAsync</span><span class=\\\"token punctuation\\\">(</span>fileName<span class=\\\"token punctuation\\\">,</span> MaxFileLength<span class=\\\"token punctuation\\\">,</span> ReadToken<span class=\\\"token punctuation\\\">.</span>Token<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\">        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>ret<span class=\\\"token punctuation\\\">)</span></span>\\n<span class=\\\"line\\\">        <span class=\\\"token punctuation\\\">{</span></span>\\n<span class=\\\"line\\\">            file<span class=\\\"token punctuation\\\">.</span>PrevUrl <span class=\\\"token operator\\\">=</span> <span class=\\\"token interpolation-string\\\"><span class=\\\"token string\\\">$\\\"/images/uploader/</span><span class=\\\"token interpolation\\\"><span class=\\\"token punctuation\\\">{</span><span class=\\\"token expression language-csharp\\\">file<span class=\\\"token punctuation\\\">.</span>FileName</span><span class=\\\"token punctuation\\\">}</span></span><span class=\\\"token string\\\">\\\"</span></span><span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\">            <span class=\\\"token keyword\\\">await</span> MessageService<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Success</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"文件上传成功！\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\">        <span class=\\\"token punctuation\\\">}</span></span>\\n<span class=\\\"line\\\">        <span class=\\\"token keyword\\\">else</span></span>\\n<span class=\\\"line\\\">        <span class=\\\"token punctuation\\\">{</span></span>\\n<span class=\\\"line\\\">            <span class=\\\"token comment\\\">// 处理保存失败情况</span></span>\\n<span class=\\\"line\\\">            <span class=\\\"token class-name\\\"><span class=\\\"token keyword\\\">var</span></span> errorMessage <span class=\\\"token operator\\\">=</span> <span class=\\\"token interpolation-string\\\"><span class=\\\"token string\\\">$\\\"保存文件失败 </span><span class=\\\"token interpolation\\\"><span class=\\\"token punctuation\\\">{</span><span class=\\\"token expression language-csharp\\\">file<span class=\\\"token punctuation\\\">.</span>OriginFileName</span><span class=\\\"token punctuation\\\">}</span></span><span class=\\\"token string\\\">\\\"</span></span><span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\">            file<span class=\\\"token punctuation\\\">.</span>Code <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\">            file<span class=\\\"token punctuation\\\">.</span>Error <span class=\\\"token operator\\\">=</span> errorMessage<span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\">            <span class=\\\"token keyword\\\">await</span> MessageService<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Error</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token interpolation-string\\\"><span class=\\\"token string\\\">$\\\"上传文件</span><span class=\\\"token interpolation\\\"><span class=\\\"token punctuation\\\">{</span><span class=\\\"token expression language-csharp\\\">errorMessage</span><span class=\\\"token punctuation\\\">}</span></span><span class=\\\"token string\\\">\\\"</span></span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\">        <span class=\\\"token punctuation\\\">}</span></span>\\n<span class=\\\"line\\\">    <span class=\\\"token punctuation\\\">}</span></span>\\n<span class=\\\"line\\\">    <span class=\\\"token keyword\\\">catch</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">Exception</span> ex<span class=\\\"token punctuation\\\">)</span></span>\\n<span class=\\\"line\\\">    <span class=\\\"token punctuation\\\">{</span></span>\\n<span class=\\\"line\\\">        <span class=\\\"token comment\\\">// 异常处理</span></span>\\n<span class=\\\"line\\\">        file<span class=\\\"token punctuation\\\">.</span>Code <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\">        file<span class=\\\"token punctuation\\\">.</span>Error <span class=\\\"token operator\\\">=</span> ex<span class=\\\"token punctuation\\\">.</span>Message<span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\">        <span class=\\\"token keyword\\\">await</span> MessageService<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Error</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token interpolation-string\\\"><span class=\\\"token string\\\">$\\\"文件上传失败: </span><span class=\\\"token interpolation\\\"><span class=\\\"token punctuation\\\">{</span><span class=\\\"token expression language-csharp\\\">ex<span class=\\\"token punctuation\\\">.</span>Message</span><span class=\\\"token punctuation\\\">}</span></span><span class=\\\"token string\\\">\\\"</span></span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\">        ret <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\">    <span class=\\\"token punctuation\\\">}</span></span>\\n<span class=\\\"line\\\">    <span class=\\\"token keyword\\\">return</span> ret<span class=\\\"token punctuation\\\">;</span></span>\\n<span class=\\\"line\\\"><span class=\\\"token punctuation\\\">}</span></span>\\n<span class=\\\"line\\\"></span></code></pre>\\n<div class=\\\"line-numbers\\\" aria-hidden=\\\"true\\\" style=\\\"counter-reset:line-number 0\\\"><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div></div></div>\"}")
export { comp, data }

if (import.meta.webpackHot) {
  import.meta.webpackHot.accept()
  if (__VUE_HMR_RUNTIME__.updatePageData) {
    __VUE_HMR_RUNTIME__.updatePageData(data)
  }
}

if (import.meta.hot) {
  import.meta.hot.accept(({ data }) => {
    __VUE_HMR_RUNTIME__.updatePageData(data)
  })
}
